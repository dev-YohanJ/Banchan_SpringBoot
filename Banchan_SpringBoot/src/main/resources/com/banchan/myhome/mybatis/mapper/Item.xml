<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.banchan.myhome.mybatis.mapper.ItemMapper">
	
	<insert id="insertItem">
		<selectKey resultType="int" order="BEFORE"
					keyProperty="id">
			select nvl(max(id),0)+1 from item			
		</selectKey>
		insert into item
		(id, name, seller, price, 
		 image, original, 
		 description, location, allergy, 
		 readcount, regdate, status
		 ) 
		 values 
		 (#{id}, #{name}, #{seller}, #{price},
		  #{image, jdbcType=VARCHAR}, #{original, jdbcType=VARCHAR},
		  #{description}, #{location}, #{allergy}, 
		  #{readcount}, SYSDATE, #{status})
	</insert>
	
	
	<select id="getListCount" resultType="int">
		select count(*) from item
	</select>
	
	
	<select id="getItemList" resultType="item">
		select * from 
		  ( select rownum rnum, b.*
		    from (select * from item) b
		    where rownum &lt;=  #{end} 
		    order by id desc     
		   ) 
	     where rnum &gt;= #{start} and rnum  &lt;=  #{end}
	     order by id desc
	</select>
	
	
	<update id="setReadCountUpdate">
		update item
		set readcount=readcount+1
		where id=#{num}
	</update>
	
	<select id="getDetail" parameterType="int" resultType="item">
		select 	* 
		from 	item
		where 	id = #{id}
	</select>
	
	
	<update id="itemModify">
	  update item 
	  set 
		     name=#{name},
		     description=#{description},
		     image=#{image, jdbcType=VARCHAR}, 
		     original=#{original, jdbcType=VARCHAR}
	  where  id=#{id}
	</update>
	
	<delete id="itemDelete">
		<![CDATA[
			delete from item
			where id = #{id} 
		]]>
	</delete>

	
	
</mapper>